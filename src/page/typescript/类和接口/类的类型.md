åœ¨ TS ä¸­ç±»æœ‰ä¸¤ä¸ªç‚¹éœ€è¦ç†è§£ï¼š

1ã€ç±»æ˜¯ç»“æ„åŒ–ç±»å‹ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„è®¿é—®ä¿®é¥°ç¬¦ä¼šè§¦å‘ TS ç±»å‹æ£€æŸ¥ã€‚

ç¤ºä¾‹ï¼š

```typescript
class User {
    constructor(
      public id: number, 
      // å…¬æœ‰çš„
      public name: string, 
      public age: number
    ) {}

    show(address: string) {
        console.log(address);
    }
}

class Person {
    constructor(
      public id: number,
      // ç§æœ‰çš„
      private name: string,
      public age: number
    ) {}

    show(address: string) {
        console.log(this.id + "---" + address);
    }
}
```

```typescript
const u = new User(1, "å¼ ä¸‰", 20);
const p = new Person(2, "æå››", 30);
const a = {
    id: 3,
    name: "ç‹äº”",
    age: 40,
    show(address: string) {
        console.log("hello " + address);
    }
};

function desc(user: User) {
    user.show("åŒ—äº¬å¸‚");
}

desc(u); // âœ…
desc(p); // âŒ å±æ€§â€œnameâ€åœ¨ç±»å‹â€œPersonâ€ä¸­æ˜¯ç§æœ‰å±æ€§ï¼Œä½†åœ¨ç±»å‹â€œUserâ€ä¸­ä¸æ˜¯
desc(a); // âœ…
```

<br />

2ã€åœ¨ TS ä¸­ç±»å³å£°æ˜å€¼ä¹Ÿå£°æ˜ç±»å‹ï¼Œè€Œä¸”ç±»çš„ç±»å‹æœ‰ä¸¤ç§ï¼šå®ä¾‹åŒ–å¯¹è±¡ç±»å‹ä¸ç±»æ„é€ å‡½æ•°ç±»å‹ã€‚

```typescript
class MyMap {
    state: Record<string, string> = {};

    get(key: string): string | undefined {
        return this.state[key];
    }

    set(key: string, value: string) {
        this.state[key] = value;
    }

    keys(): string[] {
        return Object.keys(this.state);
    }

    values(): string[] {
        return Object.values(this.state);
    }

    static of(...entries: [string, string][]): MyMap {
        const map = new MyMap();
        entries.forEach((entry) => map.set(entry[0], entry[1]));
        return map;
    }
}

const m1 = new MyMap();
m1.set("id", "1");
m1.set("name", "å¼ ä¸‰");
console.log(m1.get("id"));
console.log(m1.values());

const m2 = MyMap.of(["id", "1"], ["name", "å¼ ä¸‰"]);
console.log(m2.keys());
```

æ³¨æ„æŸ¥çœ‹ç¼–è¾‘å™¨çš„æç¤º`m1`çš„ç±»å‹æ˜¯`MyMap`ï¼š

![](imgs/1735875813228-fcb8eeea-e286-4fe7-9529-79bd430fe62f.png)

ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`m1`æ˜¯`MyMap`ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚ä½œä¸ºå®ä¾‹åŒ–åçš„å¯¹è±¡ï¼Œå®ƒå¯ä»¥é€šè¿‡`m1.xxx`æ¥è®¿é—®å¯¹åº”çš„å±æ€§å’Œæ–¹æ³•ã€‚

è€Œ`new MyMap()`æ˜¯åˆ›å»ºå®ä¾‹æ—¶è°ƒç”¨çš„æ„é€ å‡½æ•°ã€‚æ—¢ç„¶å®ƒæ˜¯ä¸€ä¸ªå€¼ï¼Œå°±åº”è¯¥å¯¹åº”ä¸€ä¸ªå€¼çš„ç±»å‹ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¯¹äºç±»ä¸­çš„é™æ€æ–¹æ³•å’Œé™æ€å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡`MyMap.xxx`æ¥è°ƒç”¨ã€‚å› æ­¤ï¼Œ`MyMap`æœ¬èº«è¿˜å¯¹åº”ä¸€ä¸ªç±»å‹ï¼Œè¿™ä¸ªç±»å‹æè¿°çš„æ˜¯`MyMap`æ„é€ å‡½æ•°çš„è¡Œä¸ºå’Œé™æ€æˆå‘˜ã€‚

<br />

ä¸‹é¢å†è¡¥å……ä¸€ä¸ªç¤ºä¾‹æ¥è¯´æ˜ï¼Œä¾‹å¦‚ç°åœ¨æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ–¹æ³•çš„å‚æ•°éœ€è¦çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¦å¤–ä¸€ä¸ªæ–¹æ³•çš„å‚æ•°éœ€è¦çš„æ˜¯ç±»æœ¬èº«ï¼Œé‚£ä¹ˆè¿™ä¸ªåº”è¯¥æ€ä¹ˆé™åˆ¶å‘¢ï¼Ÿ

```typescript
class User {
    constructor(public id: number, public name: string) {}
    show() {
        console.log(this.id, this.name);
    }
}

// æ¥å—ä¸€ä¸ª User ç±»å‹çš„å¯¹è±¡
function method1(target: User) {
    console.log(target.id);
    console.log(target.name);
    target.show();
}

// æ¥å—çš„æ˜¯ä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°ç±»å‹ï¼Œåœ¨å‡½æ•°å†…ä¸è¿›è¡Œå®ä¾‹åŒ–
function method2(target: new (...args: [number, string]) => User) {
    const t = new target(1, "jack");
}

method1(new User(1, "jack"));
method2(User);
```

TS ä¸­ä¸‹é¢çš„å†™æ³•å°±æ˜¯æ„é€ å‡½æ•°çš„ç±»å‹ï¼š

```typescript
new (...args:any[]) => any;
```

å›åˆ°ä¸Šé¢æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•è¡¨ç¤º`MyMap`ç±»è‡ªèº«çš„æ„é€ å‡½æ•°ç±»å‹å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨`typeof`å…³é”®å­—ï¼š

```typescript
type MyMapConstructorType = typeof MyMap;
```

ç”šè‡³å¯ä»¥é€šè¿‡ TS çš„ç±»å‹å·¥å…·ï¼Œ`InstanceType<T>`é€šè¿‡æ„é€ å™¨ç±»å‹å†å¾—åˆ°å®ä¾‹åŒ–ç±»å‹ï¼š

```typescript
// ğŸ¤” type MyMapInstanceType = MyMap
type MyMapInstanceType = InstanceType<MyMapConstructorType>;
```

<br />

å½“ç„¶æˆ‘ä»¬å¹¶çœ‹ä¸è§è¿™ä¸ªç±»å‹ä¸­å…·ä½“æœ‰å“ªäº›ï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡ä»¿ç€ ES å…³äºç±»çš„å¤„ç†æ¨¡æ‹Ÿä¸€ä¸‹`String`ã€`Map`è¿™äº›ç±»ï¼š

```typescript
// å®ä¾‹åŒ–å¯¹è±¡ç±»å‹
interface MyMap {
    state: Record<string, string>;
    get(key: string): string | undefined;
    set(key: string, value: string): void;
    values(): string[];
    keys(): string[];
}

// æ„é€ å‡½æ•°ç±»å‹
interface MyMapConstructor {
    new (): MyMap;
    of(...entries: [string, string][]): MyMap;
    readonly prototype: MyMap;
}
```

å¯¹äºæ„é€ å‡½æ•°ç±»å‹ï¼Œæˆ‘ä»¬åè¿‡æ¥æ¨å¯¼ä¸€æ ·æˆç«‹ï¼š

```typescript
// ğŸ¤” type M = MyMap
type M = InstanceType<MyMapConstructor>;
```

è¿™é‡Œå…¶å®å¯ä»¥å¯¹åº”æˆ‘ä»¬ Vue ä¸­çš„ä»£ç ï¼Œä¸ºæ¨¡ç‰ˆæ ‡æ³¨ç±»å‹ï¼Œå¯ä»¥çœ‹åˆ°æœ‰è¿™æ ·çš„å†™æ³•ï¼š

```vue
<script>
  import { ref } from "vue"
  import MyComp from "./components/MyComp.vue";

  type MyCompConstructor = typeof MyComp;
  type MyCompInstance = InstanceType<MyCompConstructor>;
  const myComp = ref<MyCompInstance | null>(null)
  // ç®€å†™
  // const myComp = ref<InstanceType<typeof MyComp> | null>(null)

  const openModal = () => {
    myComp.value?.open();
  }
</script>

<template>
  <MyComp ref="myComp"/>
</template>  
```

`MyComp`å®é™…å¾—åˆ°çš„æ˜¯ Vue çš„é…ç½®å¯¹è±¡ï¼Œå…¶å®å°±ç›¸å½“äº MyComp.vue æ–‡ä»¶ä¸­æ‰€å†™åœ¨`<script>`ä¸­çš„å†…å®¹ï¼ŒåŒ…æ‹¬`data`ï¼Œ`methods`ï¼Œç”Ÿå‘½å‘¨æœŸå‡½æ•°ç­‰ç­‰ã€‚

é€šè¿‡`typeof MyComp`å…¶å®å¾—åˆ°äº† Vue ç»„ä»¶çš„æ„é€ å‡½æ•°ç±»å‹ï¼Œç„¶åå†é€šè¿‡`InstanceType<MyCompConstructor>`å¾—åˆ°çœŸæ­£çš„ Vue å®ä¾‹å¯¹è±¡ç±»å‹ï¼Œæœ‰äº†è¿™æ ·çš„ç±»å‹ä¹‹åï¼Œæˆ‘ä»¬æ‰èƒ½åœ¨å£°æ˜çš„å˜é‡ä¸­è®¿é—®åˆ°`MyComp`æš´éœ²å‡ºæ¥çš„æ–¹æ³•ã€‚